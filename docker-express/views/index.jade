extends layout

block content
  .wrapper
  #div1
  #div2

  script(type='text/javascript').
    ds = deepstream( 'http://thephedds.com:6020' ).login();
    ds.event.subscribe( 'docker', function( news ){
      $(".wrapper").append('<div class="container" id="'  + news.Name + '"></div>');

      d3load( news.Name );
      console.log(news.Name);
    });


  script(language='JavaScript').
    function d3load ( containerName ) {
      scaleIn( containerName );
    }
    function labelFunction(val,min,max) {
    }
    function start( containerName, width, percent ) {
      var rp1 = radialProgress(document.getElementById(containerName))
      .label(containerName)
      .diameter(width)
      .value(percent)
      .render();
    }
    function getRandomInt(min, max) {
      return Math.floor(Math.random() * (max - min + 1)) + min;
    }

    function scaleIn( containerName ) {
      var genPercent = getRandomInt(0,100);
      var genWidth = getRandomInt(70, 150);
      var genHeight = genWidth + 8;
      $("#" + containerName ).transition({
        width: genWidth + 'px', height: genHeight + 'px',
        duration: 500,
        easing: 'in',
        complete: function() { 
          start( containerName, genWidth, genPercent ); 
          console.log('finished');
        } 
      });
    }
